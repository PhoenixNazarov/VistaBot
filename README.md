# VistaBot

## Классы
Все классы находятся в ```Users.py```
### Карты ```Cards```
Мы имеем дело с большим количеством
валют и их классификация(карты, счета, PayPal).
Что бы кластеризовать все шаблоны карт и привести их к одному классу,
был придуман следующий алгоритм.

1. Пользователь идет по последовательным вопросам, при создании шаблона для карты.
   В некоторых шаблонах есть одинаковые данные, по типу ФИО владельца, банк и т.д.
   Чтобы не повторятся и не писать одинаковый код, вопросы ссылаются на один экран.
2. Вопросы строятся по ```сценариям```.
3. После того как пользователь закончил добавление, все данные структуризируются. 
И приводятся к одному классу ```Card```.
   
Необходимые данные, которые были выявлены:
1. Название карты у пользователя
2. Валюта
3. Контактные данные карты
4. _Необязательный параметр банк, он нужен для поиска заявок по банкам_

В целях экономии места все эти данные записываются в массиве:

``` [сценарий, название карты, валюта, ...]```

**Сценарии:**

```
ve - Vista EUR
vu - Vista USD
c - Карты
a - Счета
p - PayPal
b - BYN
```

С помощью этих сценариев функции ```collect``` собирают данные из массивов и строят текст

```python
def collect(c_list):
   c_type = c_list[0]
   card_info = []
   if c_type == 've':
     card_info.append(['Валюта', 'Vista EUR'])
     card_info.append(['Номер счет', c_list[3]])
     card_info.append(['Номер телефона', c_list[4]])
   
   elif c_type == 'vu':
     card_info.append(['Валюта', 'Vista USD'])
     card_info.append(['Номер счет', c_list[3]])
     card_info.append(['Номер телефона', c_list[4]])
   
   elif c_type == 'c':
     card_info.append(['Валюта', c_list[2]])
     card_info.append(['Тип', 'Карта'])
     card_info.append(['Банк', c_list[3]])
     card_info.append(['Тип карты', c_list[4]])
     card_info.append(['Номер карты', c_list[5]])
     card_info.append(['ФИО', c_list[6]])
   
   elif c_type == 'a':
     card_info.append(['Валюта', c_list[2]])
     card_info.append(['Тип', 'Счет'])
     card_info.append(['Банк', c_list[3]])
     card_info.append(['БИК', c_list[4]])
     card_info.append(['Номер счета', c_list[5]])
     card_info.append(['ФИО', c_list[6]])
   
   elif c_type == 'p':
     card_info.append(['Валюта', c_list[2]])
     card_info.append(['Тип', 'PayPal'])
     card_info.append(['Mail', c_list[3]])
   
   elif c_type == 'b':
     card_info.append(['Валюта', c_list[2]])
     card_info.append(['Банк', c_list[3]])
     card_info.append(['Тип карты', c_list[4]])
     card_info.append(['ФИО', c_list[5]])
     card_info.append(['Дата действия', c_list[6]])
```

### Заявки 

**Процесс создания заявки** ```Ask```
1. Выбор первой валюты, которую хочет отдать. ```проверка наличия карт, если это фиатная валюта.```
2. Ввод суммы первой валюты.
3. Выбор второй валюты, которую хочет получить.
4. Выбор курса.

_Далее разделение_. Если пользователь отдает Vst:
5. Выбор шаблонов карт, куда пользователь хочет получить фиатную валюту.
6. Выбор vst шаблона, с какого счета гарант получит vst.

Если пользователь хочет получить Vst.
5. Выбор банков, куда он готов перевести фиатную валюту.
6. Выбор vst шаблона, на какой счет гарант должен отправить vst.


### Сделки ```Deal```
При создании сделки, пользователи занимает одно из этих двух мест:
1. **Отдает Vst**

```vista_people : ID``` - Отдает vista, получает фиатную валюту.

```vista_people_vst_card``` - Карта vista, откуда прейдет перевод гаранту.

```vista_people_fiat_card``` - Карты фиат, куда второй пользователь должен отправить фиатную валюту.

2. **Получает Vst**

```fiat_people : ID``` - Отдает фиатную валюту, получает vista.

```fiat_people_vst_card``` - Карта vista, куда пользователь должен получить vst от гаранта.

```fiat_people_banks``` - Банки, на которые пользователь готов отправить фиатную валюту.

**Статусы сделки**
1. ```wait_vst``` - ожидание перевода от vst пользователя на счет гаранта
2. ```wait_vst_proof``` - ожидание подтверждения гаранта
3. ```wait_fiat``` - ожидание перевода фитной валюты от фиатного пользователя
4. ```wait_fiat_proof``` - ожидание подтверждение от vst пользователя
5. ```wait_garant_vst``` - ожидание перевода от гаранта на vst счет фиатного пользователя